\section{研究背景及意义}
随着现代科技的飞速发展，数字图像成为了人们获取信息、传达思想的重要载体。而高质量的数字图像可以给人们带来更加真实、清晰的视觉体验，或在监控、救灾等领域起到重要的作用。而实际应用中，由于图像采集设备、传输通道等原因，图像常常受到噪声、模糊、压缩、下采样等各种退化影响，使得其分辨率较低，缺乏细节信息，不利于人类的使用。因此在计算机视觉领域中，图像超分辨率（Single Image Super-resolution, SISR）技术成为了一个备受关注的研究方向。

图像超分辨技术的目的是通过将低分辨率图像提高分辨率，从而得到更加清晰、细节更加丰富的图像。早期的超分辨率技术主要研究合成图像的超分辨率，通常假设高分辨率图像经由高斯模糊与双三次下采样过程退化为低分辨率图像。传统的方法包括插值、稀疏表示等，而借由深度学习技术，研究者已提出许多优秀的合成图像的超分辨率模型。但将这些模型应用于真实图像时，会发现效果严重下降。由于真实图像的退化可能是由多种且未知的因素引起的，图像超分辨率处理难度较大。因此，如何提高真实图像的分辨率成为了图像超分辨技术中的重要研究方向。

在真实图像超分辨率中，基于图像退化模型估计的真实图像超分辨方法因其能够通过模拟图像退化过程来获取更加真实的成对高、低分辨率图像数据集用以训练超分辨率网络，而备受关注。这种方法能够在不同程度的噪声和模糊条件下提供更加清晰、细节更加丰富的超分辨图像。因此，本文将研究基于图像退化模型估计的真实图像超分辨方法，探索一种更加高效、准确的图像超分辨技术。

本文将对图像退化过程进行建模，通过合理的退化过程，生成更加真实且多样性的低分辨率图像，并在实验中进行评估，验证其与真实图像的相似性，进而使得能够通过生成的低分辨率图像训练一个超分辨率网络，使其具有将真实的低分辨率图像重建为高分辨率图像的能力。该研究成果可以为图像超分辨领域的相关研究提供借鉴和参考，同时也可以为图像采集、传输等领域的研究提供更加深刻的思考和理解，有助于推动图像处理技术的发展。另外，随着人工智能技术的不断发展，图像超分辨技术也逐渐应用于各个领域，如摄影、视频监控、医疗影像等。因此，本文的研究也具有重要的实际应用价值。

综上所述，本文将探究基于图像退化模型估计的真实图像超分辨方法，旨在提高真实图像的超分辨率，并为图像处理技术的发展和应用提供借鉴和参考。该研究成果对于推动图像超分辨技术在各个领域的应用和发展具有重要意义。
\section{历史及现状}
\subsection{传统的超分辨率技术}
在2014年以前，图像超分辨率技术主要采用计算机视觉领域中传统的方法。其中包括插值、稀疏表示、局部嵌入等，其中最基础的方法是基于插值算法的上采样。常用的插值算法可分为双线性插值、双二次插值和双三次插值，其精细度依次增加。由于超分辨率是使图像的像素增加的过程，这意味着原图中的像素之间将会加入更多像素。由于图像的像素是离散的，而我们并不知道真实的描述图像的连续函数$f(x,y)$，故为了确定新增像素的值，可以使用插值算法，即给出一个插值函数$g(x,y)$，其中对于图像中的每个像素$f(x_i,y_i)$，有$g(x_i,y_i)=f(x_i,y_i)$。对于新增的像素点，使用插值函数算出其值即可。插值算法的优点是简单、快速，缺点是不够真实，不能补充较为详细的细节信息。

随着技术的发展，稀疏表示方法逐渐成为研究的热点。Yang等人\parencite{4587647}指出，可将图像分解为字典$D$与原子$\alpha$，其中高、低分辨率图像的原子类似，而字典不同。此算法首先使用成对的高低分辨率数据集训练字典，在推理时，通过字典$D_l$计算出低分辨率图像的原子，再使用此原子与高分辨率图像的字典$D_h$计算出高分辨率图像。由于最初的稀疏表示方法没有考虑图像的噪声、模糊的问题，Dong等人\parencite{6392274}提出了稀疏编码噪声的概念，将算法优化目标转为降低稀疏编码噪声，通过图像非局部自相似性获得了对图像稀疏编码的良好估计。稀疏编码方法在PSNR与SSIM指标上较插值算法更高，也能还原更多的细节，但生成的高分辨率图像中带有较为明显的锯齿。

\subsection{基于深度学习的超分辨率}
随着AlexNet\parencite{NIPS2012_c399862d}在2012年的ImageNet竞赛中得冠，基于深度卷积神经网络的模型逐渐进入计算机视觉研究者的视野，而后续的VGG\parencite{simonyan2014very}、GoogleNet\parencite{szegedy2015going}等则更让此类方法成为了计算机视觉研究的主流。2014年，Dong等人\parencite{SRCNN}提出了基于卷积神经网络的SRCNN，开创了使用深度学习方法研究图像超分辨率问题的先河。作者将传统稀疏表示方法的过程抽象为三层卷积神经网络，其中第一层提取低分辨率图像的特征图，第二层将特征图与高分辨率图像的稀疏表示相对应，第三层结合空间邻域的预测完成高分辨率图像的重建。SRCNN在保证其推理速度更快的同时，其超分辨率效果远超其他传统模型。

然而，由于SRCNN只有三层，并没有完全利用深度卷积神经网络的优势。在接下来一段时间中，研究者提出了多种改进模型，从模型深度、残差连接、密集(dense)连接等角度对基于卷积神经网络的超分辨率模型进行了优化，使模型在准确度方面有了进一步的提升。但对于较大的放大倍数，这些模型却无法恢复出较为精细的纹理细节。随着生成对抗网络(GAN)这一框架在计算机视觉领域中逐渐流行，Ledig等人提出了基于GAN的模型SRGAN，其中，生成器负责生成更为真实的高分辨率图像，而判别器则负责分辨生成的高分辨率图像和真实数据集中的高分辨率图像。通过这一框架，对大的放大倍率来说，可以重建出更逼真的图像。此后，超分辨率模型多会基于GAN设计，本文亦是如此。

\subsection{真实图像的超分辨率}
最初，许多超分辨率模型通常假设高分辨率图像是通过高斯模糊和双三次下采样退化为低分辨率图像的，其训练集与测试集都是采用上述退化过程产生的合成数据集。然而，当将这些模型应用于真实场景下时，会发现图像的重建能力严重下降，并产生难以预料的伪影。这是由于真实高分辨率图像是通过噪声、模糊、图像压缩等未知且复杂的方式退化为低分辨率图像，导致真实的低分辨率图像与合成的低分辨率图像在纹理细节、模糊程度等方面完全不一致。为了解决真实图像的超分辨率问题，可以使用真实成对的数据集（如City100，RealSR等）训练超分辨率网络，从而提升模型对真实图像的重建能力。但是，从一方面来说，真实成对数据集的采集工作是费时费力且高成本的，故无法取得大量的；从另一方面来说，对于某些任务来说（如修复老照片，老电影等），低分辨率图像本身没有对应的高分辨率图像，无法进行监督式的训练。因此，必须对模型本身进行改进，以满足真实图像超分辨率任务的需求。在发展早期阶段，Yuan等人提出了无监督模型CinCGAN，作者利用两个CycleGAN，分别将低分辨率图像进行去模糊去噪处理和超分辨率，其中生成性损失通过重构损失和内容损失(identity loss)计算，第一个网络使用干净的非成对的低分辨率图像计算对抗性损失，而第二个网络使用非成对的高分辨率图像计算对抗性损失。作为无监督模型，CinCGAN取得了和监督式模型相当的超分辨率效果，但由于模型过于复杂，带来了许多精度上的下降。

为了能以较小的计算成本去训练一个更具泛化性的模型，Fritsche等人开创性地提出了DSGAN模型，意为DownSampleGAN。该模型由两部分组成，依次进行训练。其中，第一部分为下采样模型，将高分辨率图像退化为贴近真实的低分辨率图像。为保证这一点，使用高频滤波获得生成图像与真实图像的高频信息（纹理细节），并计算对抗损失。通过此模型，可以针对只有高分辨率图像的数据集生成大量伪成对的低分辨率图像。而第二部分为超分辨率模型，使用第一部分模型生成的伪成对数据集进行训练。基于这一模型框架，许多后续工作在生成图像与真实图像的域差距、显式估计模糊核、退化的随机性等方面优化了这一框架的性能。然而，这些工作往往假定图像的退化过程是确定性的，即一张高分辨率图像只能退化为一张低分辨率图像。而实际情景中，由于各种因素影响，图像的退化过程往往是具有不确定性的，即一张高分辨率图像可以经由不同的方式退化为不同的低分辨率图像。

%此处插入DSGAN图片

为了估计这种不确定性，并将其用于更好地生成低分辨率图像，Ning等人提出基于不确定性学习的无监督超分辨率模型USR-DU。作者首先探究了真实图像的退化规律，发现真实的低分辨率图像与双三次下采样图像之间的差异可以使用拉普拉斯分布来表征，该分布的位置参数代表了低分辨率图像的基准像素值，而尺度参数则代表了像素值的不确定性。与上述工作类似，此模型分为降采样部分DSN和超分部分SRN。其中，DSN输入高分辨率图像，生成拟真的低分辨率图像及其不确定性，二者拥有相同的尺寸。生成的低分辨率图像与高分辨率图像的双三次下采样结果计算内容损失，与非成对的真实低分辨率图像计算对抗性损失。为了确保生成图像及其不确定性也满足拉普拉斯分布，在计算内容损失时，采用KL散度使得生成的分布逼近实际的分布。为了能在特征域也考虑不确定性，DSN另外生成了拟真低分辨率图像经由VGG提取的特征图的不确定性，并使用生成图像的特征图与双三次下采样图像的特征图计算感知损失（同样使用KL散度）。在DSN网络训练完成后，使用DSN生成大量的伪成对数据集训练SRN。其中，伪成对数据集中的低分辨率图像由生成的低分辨率图像及其不确定性依照拉普拉斯分布随机采样获取。借由不确定性学习，USR-DU在减少伪影的同时提高了超分辨率图像的清晰度。但是，当将此模型应用到模型性较大的数据集（如RealSR）中时，其超分辨率性能有所下降。这是由于其DSN部分忽略了图像退化过程中的模糊性因素，直接使用了干净的双三次下采样图像作为参考图像，而如何在DSN中引入模糊信息，则是本文研究的重点。

%此处插入USR-DU图片

除了上述方法，也有部分工作采取显式估计模糊核，并将模糊核作为特征融合到超分辨率网络中的方式来训练真实图像超分辨率模型。其中，Liang等人提出了MANet，训练了一个空间变化地估计低分辨率图像模糊核的网络，并使用此网络对修改过的RRDB-SFT超分网络进行微调，从而实现真实图像超分辨率。Fang等人提出了KULNet，同步训练了核估计网络和超分辨率网络，并引入了不确定性学习，增强了模型的稳定性。Fang等人提出了UFPNet，基于流模型空间可变地估计了运动模糊核，具体来说，首先训练了一个可生成运动模糊核的流模型，再训练了一个模糊核隐代码估计网络，使用估计的隐代码来生成最终的模糊核，其中，隐代码的估计采用了不确定性学习。随后，将估计的模糊核融合到超分辨率网络中。此模型兼顾了空间可变模糊核估计和不确定性学习，使得模型的稳定性和准确性进一步增强。为了解决引入模糊信息的问题，对上述核估计模型的利用必不可少。

\section{论文的主要内容及工作安排}
本论文主要目的是解决USR-DU模型在模糊信息的利用上不足导致对较模糊的低分辨率图像重建能力较差的问题。为此提出了若干条改进方案，形成了改进模型UBSR-DU。

第一章阐述了基于退化模型估计的真实图像超分辨这一研究目标的意义，介绍了有关图像超分辨率这一领域的发展历史和相关工作。

第二章介绍了有关深度卷积神经网络、拉普拉斯分布、KL散度、流模型等本文所使用的相关技术。

第三章通过实验解释了USR-DU具有什么样的缺陷，并指出这种缺陷来自于模型的DSN部分对真实低分辨率图像模糊信息的忽略。进而提出了引入真实图像模糊信息的可选方案，通过实验得出了最佳改进方案。随后，经过详细的消融实验验证了此方案的有效性、可靠性和必要性。最后，比较了提出的模型与现有最先进的模型之间的效果、性能差异。

第四章对全文工作进行了总结，给出了所提出模型的局限性，并给出了可行的进一步研究方向。